
@{
    ViewBag.Title = "Create";
    List<WhareHouse.Models.PRODUCT> listpro = ViewBag.listPro;
    List<WhareHouse.Models.PRODUCT> listpro2 = ViewBag.listPro2;
    List<WhareHouse.Models.TICKETDETAILS> td = ViewBag.listTicketDetails;
    var innerjoinTdP = (from p in listpro2 join t in td on p.IDBARCODE equals t.TDIDBARCODE select new {t,p}).ToList();
    long ticketID = ViewBag.idTicket;
}


<div class="breadcrumb topBar">
    <div class="topButtonsContainer">
        @Html.ActionLink("Realizar Venta", "Create", null, new { @class = "btn btn-outline-primary topButtons" })
    </div>
    <div class="topButtonsContainer">
        @Html.ActionLink("Lista Ventas", "Index", null, new { @class = "btn btn-outline-primary topButtons" })
    </div>
</div>

<div>
    <div class="Venta-Create">
        <div class="alingCenter" >
                <p>Fecha Emision: @System.DateTime.Now.ToString("dd-MM-yyyy")</p>
        </div>
        <div class="input-group" style="width:200px">
            <div class="Inputstext">
            <p>Hora Emision:</p>
            </div>
            <div class="Inputstext">
                <p id="MyClockDisplay" class="clock" onload="showTime()"></p>
            </div>
        </div>

        <div>
            <p>N° Boleta: @ticketID</p>
        </div>
    </div>
    <div class="border border-info rounded">
        <div class="centerCreatesale">
            <h3>Ingrese El Codigo De Barra De Los Productos</h3>
        </div>
        <div style="padding-top: 40px;">
            <div class="form-group centerCreatesale2 ">
                @using (Html.BeginForm("ticketDetails", "Venta", FormMethod.Post, new { @style = "width:400px;" }))
                {
                    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                    @Html.AntiForgeryToken()
                    <div class="centerCreatesale3" style="padding-right:10px;">
                        <i class="fas fa-barcode fa-5x" style="padding-right:10px;"></i>
                        @Html.Editor("id", new { htmlAttributes = new { @class = "form-control", @style = "width:200px;" } })
                        <input type="submit" value="Buscar" class="btn btn-primary" style="height: 40px; margin-left: 5px;" />
                    </div>

                }
            </div>
            <div class="form-group formTable" style="margin-top: 20px;">
                @using (Html.BeginForm("ViegbagTicketDetails", "Venta", FormMethod.Post, new { @style = "width:100%;", @class = "FormVenta" }))
                {
                    <table class="table table-bordered" width="100%" cellspacing="0">
                        <thead class="theadAling">
                            <tr>
                                <th>Nombre Producto</th>
                                <th>Tipo Producto</th>
                                <th>Precio Venta</th>
                                <th>Cantidad</th>

                            </tr>
                        </thead>
                        <tbody>

                            @if (listpro == null)
                            {
                                <tr>
                                    <td>Ingrese</td>
                                    <td>Codigo</td>
                                    <td>De</td>
                                    <td>Barra</td>
                                </tr>
                            }
                            else
                            {
                                for (int i = 0; i < listpro.Count(); i++)
                                {
                                    <tr>
                                        <td>@Html.DisplayFor(model => listpro[i].PRODUCTNAME)</td>
                                        <td>@Html.DisplayFor(model => listpro[i].PRODUCTTYPE)</td>
                                        <td>@Html.DisplayFor(model => listpro[i].SALEPRICE)</td>
                                        <td>@Html.TextBox("quantity", 1, new { @type = "number", @style = "width: 100px;", @min = 1, @max = 100 })</td>
                                        @Html.Hidden("IdBarcode", listpro[i].IDBARCODE)
                                        @Html.Hidden("SalePrice", listpro[i].SALEPRICE)
                                    </tr>
                                }
                            }



                        </tbody>
                    </table>
                    @Html.Hidden("IdTicket", ticketID);
                    <input type="submit" value="Agregar" class="btn btn-primary btn-center " style="height: 40px; width: 300px;" />
                }



            </div>

        </div>
    </div>

    <div>
        <div class="card mb-3">
            <div class="card-header">
                <i class="fas fa-table"></i>
                Data Table Example
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-bordered" width="100%" cellspacing="0">
                        <thead class="theadAling">
                            <tr>
                                <th>Nombre Producto</th>
                                <th>Tipo Producto</th>
                                <th>Precio Venta</th>
                                <th>Cantidad</th>
                                <th>Total</th>


                            </tr>
                        </thead>
                        <tfoot>
                            <tr>
                                <th>Nombre Producto</th>
                                <th>Tipo Producto</th>
                                <th>Precio Venta</th>
                                <th>Cantidad</th>
                                <th>Total</th>

                            </tr>
                        </tfoot>
                        <tbody>

                            @if (innerjoinTdP == null)
                            {
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            }
                            else
                            {

                                for (int i = 0; i < innerjoinTdP.Count(); i++)
                                {
                            <tr>
                                <td>
                                    @Html.DisplayFor(modelItem => innerjoinTdP[i].p.PRODUCTNAME)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => innerjoinTdP[i].p.PRODUCTTYPE)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => innerjoinTdP[i].p.SALEPRICE)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => innerjoinTdP[i].t.QUANTITY)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => innerjoinTdP[i].t.TOTAL)
                                </td>

                            </tr>
                                }

                            }

                        </tbody>
                        </table>
                </div>
            </div>
            <div class="card-footer small text-muted">Updated yesterday at 11:59 PM</div>
        </div>
    </div>
    <div class="FotterSale">
        <div style="padding-right:30%; padding-bottom:20px;">
            <input type="submit" value="Cobrar" class="btn btn-success" style="width:300px" />
        </div>
        <div style="padding-right:30px;">
            <p>Total: 5000</p>
        </div>
    </div>
</div>